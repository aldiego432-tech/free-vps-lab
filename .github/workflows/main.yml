name: Free VPS Web (Cloudflare)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Update system
        run: sudo apt update

      - name: Install cloudflared
        run: |
          wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
          sudo dpkg -i cloudflared-linux-amd64.deb

      - name: Start simple web server
        run: |
          echo "ðŸ”¥ VPS activa en GitHub Actions ðŸ”¥" > index.html
          python3 -m http.server 8080 &

      - name: Start Cloudflare tunnel
        run: |
          cloudflared tunnel --url http://localhost:8080 > tunnel.log 2>&1 &
          sleep 10
          cat tunnel.log

      - name: Keep session alive
        run: sleep 3600
